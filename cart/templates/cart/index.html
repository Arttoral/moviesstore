{% extends 'base.html' %}
{% block content %}
{% load static %}
{% load cart_filters %}

<div class="p-3">
  <div class="container">
    <div class="row mt-3">
      <div class="col mx-auto mb-3">
        <h2>Shopping Cart</h2>
        <hr />
      </div>
    </div>

    <!-- Display Cart 1 -->
    <div class="row m-1">
      <h3>Cart 1</h3>
      {% if template_data.cart1_movies %}
        <table class="table table-bordered table-striped text-center">
          <thead>
            <tr>
              <th>ID</th>
              <th>Name</th>
              <th>Price</th>
              <th>Quantity</th>
            </tr>
          </thead>
          <tbody>
            {% for movie in template_data.cart1_movies %}
            <tr>
              <td>{{ movie.id }}</td>
              <td>{{ movie.name }}</td>
              <td>${{ movie.price }}</td>
              <td>{{ request.session.cart1|get_quantity:movie.id }}</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
        <div class="text-end mb-3">
          <b>Total to pay:</b> ${{ template_data.cart1_total }}
        </div>
      {% else %}
        <p>Cart 1 is empty.</p>
      {% endif %}
    </div>
    <hr/>

    <!-- Display Cart 2 -->
    <div class="row m-1">
      <h3>Cart 2</h3>
      {% if template_data.cart2_movies %}
        <table class="table table-bordered table-striped text-center">
          <thead>
            <tr>
              <th>ID</th>
              <th>Name</th>
              <th>Price</th>
              <th>Quantity</th>
            </tr>
          </thead>
          <tbody>
            {% for movie in template_data.cart2_movies %}
            <tr>
              <td>{{ movie.id }}</td>
              <td>{{ movie.name }}</td>
              <td>${{ movie.price }}</td>
              <td>{{ request.session.cart2|get_quantity:movie.id }}</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
        <div class="text-end mb-3">
          <b>Total to pay:</b> ${{ template_data.cart2_total }}
        </div>
      {% else %}
        <p>Cart 2 is empty.</p>
      {% endif %}
    </div>
    <hr/>

    <!-- Display Cart 3 -->
    <div class="row m-1">
      <h3>Cart 3</h3>
      {% if template_data.cart3_movies %}
        <table class="table table-bordered table-striped text-center">
          <thead>
            <tr>
              <th>ID</th>
              <th>Name</th>
              <th>Price</th>
              <th>Quantity</th>
            </tr>
          </thead>
          <tbody>
            {% for movie in template_data.cart3_movies %}
            <tr>
              <td>{{ movie.id }}</td>
              <td>{{ movie.name }}</td>
              <td>${{ movie.price }}</td>
              <td>{{ request.session.cart3|get_quantity:movie.id }}</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
        <div class="text-end mb-3">
          <b>Total to pay:</b> ${{ template_data.cart3_total }}
        </div>
      {% else %}
        <p>Cart 3 is empty.</p>
      {% endif %}
    </div>
    <hr/>

    <!-- Purchase & Clear Buttons -->
    <div class="row">
      <div class="text-end">
        {% if request.session.cart1 or request.session.cart2 or request.session.cart3 %}
          <a href="{% url 'cart.purchase' %}" class="btn bg-dark text-white mb-2">Purchase</a>
          <a href="{% url 'cart.clear' %}">
            <button class="btn btn-danger mb-2">Remove all movies from all Carts</button>
          </a>
        {% endif %}
      </div>
    </div>

  </div>
</div>

{% endblock content %}
